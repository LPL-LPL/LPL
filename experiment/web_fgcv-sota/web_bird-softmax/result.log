args Namespace(arch='resnet50', batch_size=48, closeset_ratio=0.2, conf_ema_range=[0.8, 0.9], cosine=True, dataset='web-bird', epochs=100, epsilon=0.6, exp_dir='experiment/SOTA-0728/resnet18car2023-08-07-09-40-54ds_web-bird_pr_0.1_lr_0.02_ep_100_ps_1_lw_0.1_heir_False_warmupepochs_10_rechange_per_epoch_35', forget_rate=0.25, gpu=0, hierarchical=False, loss_weight1=0.1, loss_weight2=0.3, loss_weight3=1.0, loss_weight4=1.5, low_dim=512, lr=0.02, lr_decay_epochs='100,150,180', lr_decay_rate=0.1, moco_m=0.99, moco_queue=8192, momentum=0.8, n_classes=200, noise_type='symmetric', partial_rate=0.1, print_freq=100, prot_start=1, proto_m=0.998, rechange_per_epoch=35, resume='', seed=123, synthetic_data=None, topk=15, warmupepochs=10, warmuplr=0.01, weight_decay=0.0011, workers=32)

Epoch 0: TrainACC 16.352005004882812, Acc 33.74655532836914, Best Acc 0. (lr 0.01, MMC 1.0)
Epoch 1: TrainACC 34.87956619262695, Acc 46.83195495605469, Best Acc 33.74655532836914. (lr 0.01, MMC 1.0)
Epoch 2: TrainACC 43.831398010253906, Acc 56.81818389892578, Best Acc 46.83195495605469. (lr 0.01, MMC 1.0)
Epoch 3: TrainACC 50.17902374267578, Acc 59.33195495605469, Best Acc 56.81818389892578. (lr 0.01, MMC 1.0)
Epoch 4: TrainACC 55.647789001464844, Acc 66.01239776611328, Best Acc 59.33195495605469. (lr 0.01, MMC 1.0)
Epoch 5: TrainACC 59.90670394897461, Acc 68.64669799804688, Best Acc 66.01239776611328. (lr 0.01, MMC 1.0)
Epoch 6: TrainACC 65.10417938232422, Acc 68.42286682128906, Best Acc 68.64669799804688. (lr 0.01, MMC 1.0)
Epoch 7: TrainACC 68.2834243774414, Acc 68.73278045654297, Best Acc 68.64669799804688. (lr 0.01, MMC 1.0)
Epoch 8: TrainACC 71.52236938476562, Acc 65.32369232177734, Best Acc 68.73278045654297. (lr 0.01, MMC 1.0)
Epoch 9: TrainACC 74.13737487792969, Acc 67.92355346679688, Best Acc 68.73278045654297. (lr 0.01, MMC 0.7664967179298401)
    ----------  warmup end  -----------    
Epoch 10: TrainACC tensor([60.40], device='cuda:0'), Acc 56.02617263793945, Best Acc 68.73278045654297. (lr 0.019511054597788586, MMC 0.7149219512939453)
Epoch 11: TrainACC tensor([65.29], device='cuda:0'), Acc 60.98484802246094, Best Acc 68.73278045654297. (lr 0.019409398881852714, MMC 0.6844910979270935)
Epoch 12: TrainACC tensor([69.50], device='cuda:0'), Acc 65.54752349853516, Best Acc 68.73278045654297. (lr 0.019298467094023632, MMC 0.6698302030563354)
Epoch 13: TrainACC tensor([71.78], device='cuda:0'), Acc 64.7727279663086, Best Acc 68.73278045654297. (lr 0.019178368710582972, MMC 0.6660232543945312)
Epoch 14: TrainACC tensor([72.90], device='cuda:0'), Acc 65.92630767822266, Best Acc 68.73278045654297. (lr 0.019049222254135537, MMC 0.669253945350647)
Epoch 15: TrainACC tensor([73.42], device='cuda:0'), Acc 68.8188705444336, Best Acc 68.73278045654297. (lr 0.018911155176641794, MMC 0.676531970500946)
Epoch 16: TrainACC tensor([73.85], device='cuda:0'), Acc 63.39531707763672, Best Acc 68.8188705444336. (lr 0.018764303733638195, MMC 0.6861441135406494)
Epoch 17: TrainACC tensor([73.54], device='cuda:0'), Acc 62.74104690551758, Best Acc 68.8188705444336. (lr 0.018608812849769396, MMC 0.6964578628540039)
Epoch 18: TrainACC tensor([73.76], device='cuda:0'), Acc 63.326446533203125, Best Acc 68.8188705444336. (lr 0.01844483597576513, MMC 0.7071776986122131)
Epoch 19: TrainACC tensor([73.64], device='cuda:0'), Acc 66.2534408569336, Best Acc 68.8188705444336. (lr 0.01827253493700287, MMC 0.7176178693771362)
Epoch 20: TrainACC tensor([73.49], device='cuda:0'), Acc 65.22039031982422, Best Acc 68.8188705444336. (lr 0.018092079773805725, MMC 0.727694034576416)
Epoch 21: TrainACC tensor([73.59], device='cuda:0'), Acc 58.31611633300781, Best Acc 68.8188705444336. (lr 0.017903648573633146, MMC 0.7373439073562622)
Epoch 22: TrainACC tensor([72.53], device='cuda:0'), Acc 64.78994750976562, Best Acc 68.8188705444336. (lr 0.017707427295330137, MMC 0.7457007765769958)
Epoch 23: TrainACC tensor([72.77], device='cuda:0'), Acc 59.917354583740234, Best Acc 68.8188705444336. (lr 0.01750360958560829, MMC 0.7529069781303406)
Epoch 24: TrainACC tensor([73.31], device='cuda:0'), Acc 57.334712982177734, Best Acc 68.8188705444336. (lr 0.017292396587939903, MMC 0.7593653202056885)
Epoch 25: TrainACC tensor([73.03], device='cuda:0'), Acc 61.673553466796875, Best Acc 68.8188705444336. (lr 0.017073996744053608, MMC 0.7648946046829224)
Epoch 26: TrainACC tensor([73.73], device='cuda:0'), Acc 64.44559478759766, Best Acc 68.8188705444336. (lr 0.0168486255882276, MMC 0.7698455452919006)
Epoch 27: TrainACC tensor([74.87], device='cuda:0'), Acc 64.85881805419922, Best Acc 68.8188705444336. (lr 0.01661650553458328, MMC 0.774763286113739)
Epoch 28: TrainACC tensor([74.75], device='cuda:0'), Acc 61.484161376953125, Best Acc 68.8188705444336. (lr 0.016377865657589412, MMC 0.7787386178970337)
Epoch 29: TrainACC tensor([74.53], device='cuda:0'), Acc 63.670799255371094, Best Acc 68.8188705444336. (lr 0.016132941465993235, MMC 0.7825264930725098)
Epoch 30: TrainACC tensor([75.63], device='cuda:0'), Acc 67.18319702148438, Best Acc 68.8188705444336. (lr 0.01588197467040181, MMC 0.7861844301223755)
Epoch 31: TrainACC tensor([75.49], device='cuda:0'), Acc 69.19766235351562, Best Acc 68.8188705444336. (lr 0.015625212944742787, MMC 0.7893438935279846)
Epoch 32: TrainACC tensor([76.30], device='cuda:0'), Acc 65.01377868652344, Best Acc 69.19766235351562. (lr 0.015362909681840176, MMC 0.7929750680923462)
Epoch 33: TrainACC tensor([76.60], device='cuda:0'), Acc 71.9869155883789, Best Acc 69.19766235351562. (lr 0.01509532374334621, MMC 0.7967109084129333)
Epoch 34: TrainACC tensor([77.12], device='cuda:0'), Acc 70.86776733398438, Best Acc 71.9869155883789. (lr 0.014822719204276136, MMC 0.7997747659683228)
Epoch 35: TrainACC tensor([77.54], device='cuda:0'), Acc 69.02548217773438, Best Acc 71.9869155883789. (lr 0.014545365092398073, MMC 0.8028565645217896)
Epoch 36: TrainACC tensor([77.59], device='cuda:0'), Acc 65.99517822265625, Best Acc 71.9869155883789. (lr 0.014263535122735076, MMC 0.805624783039093)
Epoch 37: TrainACC tensor([78.07], device='cuda:0'), Acc 69.33540344238281, Best Acc 71.9869155883789. (lr 0.013977507427441457, MMC 0.80838942527771)
Epoch 38: TrainACC tensor([78.06], device='cuda:0'), Acc 69.4042739868164, Best Acc 71.9869155883789. (lr 0.013687564281319935, MMC 0.8105432987213135)
Epoch 39: TrainACC tensor([78.35], device='cuda:0'), Acc 65.78856658935547, Best Acc 71.9869155883789. (lr 0.013393991823250464, MMC 0.8121333718299866)
Epoch 40: TrainACC tensor([77.88], device='cuda:0'), Acc 70.83333587646484, Best Acc 71.9869155883789. (lr 0.013097079773805725, MMC 0.8132894039154053)
Epoch 41: TrainACC tensor([78.04], device='cuda:0'), Acc 70.11019134521484, Best Acc 71.9869155883789. (lr 0.0127971211493319, MMC 0.8146871328353882)
Epoch 42: TrainACC tensor([78.42], device='cuda:0'), Acc 70.07575988769531, Best Acc 71.9869155883789. (lr 0.012494411972776898, MMC 0.815769374370575)
Epoch 43: TrainACC tensor([78.88], device='cuda:0'), Acc 70.54063415527344, Best Acc 71.9869155883789. (lr 0.012189250981551462, MMC 0.8172159790992737)
Epoch 44: TrainACC tensor([74.28], device='cuda:0'), Acc 70.19628143310547, Best Acc 71.9869155883789. (lr 0.01188193933271139, MMC 0.8165244460105896)
Epoch 45: TrainACC tensor([78.28], device='cuda:0'), Acc 69.35261535644531, Best Acc 71.9869155883789. (lr 0.011572780305751908, MMC 0.8126319646835327)
Epoch 46: TrainACC tensor([79.18], device='cuda:0'), Acc 72.88223266601562, Best Acc 71.9869155883789. (lr 0.011262079003307402, MMC 0.8100138306617737)
Epoch 47: TrainACC tensor([79.63], device='cuda:0'), Acc 73.48484802246094, Best Acc 72.88223266601562. (lr 0.010950142050051959, MMC 0.8084394335746765)
Epoch 48: TrainACC tensor([79.71], device='cuda:0'), Acc 71.3154296875, Best Acc 73.48484802246094. (lr 0.010637277290097842, MMC 0.807636559009552)
Epoch 49: TrainACC tensor([79.75], device='cuda:0'), Acc 73.98416137695312, Best Acc 73.48484802246094. (lr 0.010323793483190501, MMC 0.8076263070106506)
Epoch 50: TrainACC tensor([80.14], device='cuda:0'), Acc 72.71005249023438, Best Acc 73.98416137695312. (lr 0.01001, MMC 0.8079676032066345)
Epoch 51: TrainACC tensor([80.24], device='cuda:0'), Acc 72.15909576416016, Best Acc 73.98416137695312. (lr 0.009696206516809499, MMC 0.8087527751922607)
Epoch 52: TrainACC tensor([80.58], device='cuda:0'), Acc 74.48347473144531, Best Acc 73.98416137695312. (lr 0.00938272270990216, MMC 0.809501051902771)
Epoch 53: TrainACC tensor([80.75], device='cuda:0'), Acc 76.32575988769531, Best Acc 74.48347473144531. (lr 0.009069857949948041, MMC 0.8104516863822937)
Epoch 54: TrainACC tensor([80.64], device='cuda:0'), Acc 76.51515197753906, Best Acc 76.32575988769531. (lr 0.0087579209966926, MMC 0.8117377758026123)
Epoch 55: TrainACC tensor([81.20], device='cuda:0'), Acc 74.86225891113281, Best Acc 76.51515197753906. (lr 0.008447219694248094, MMC 0.8127210736274719)
Epoch 56: TrainACC tensor([81.22], device='cuda:0'), Acc 76.73898315429688, Best Acc 76.51515197753906. (lr 0.00813806066728861, MMC 0.8136321902275085)
Epoch 57: TrainACC tensor([81.08], device='cuda:0'), Acc 74.81060791015625, Best Acc 76.73898315429688. (lr 0.007830749018448543, MMC 0.8143787980079651)
Epoch 58: TrainACC tensor([81.12], device='cuda:0'), Acc 76.67011260986328, Best Acc 76.73898315429688. (lr 0.0075255880272231, MMC 0.8146339058876038)
Epoch 59: TrainACC tensor([81.27], device='cuda:0'), Acc 73.62258911132812, Best Acc 76.73898315429688. (lr 0.007222878850668101, MMC 0.8151902556419373)
Epoch 60: TrainACC tensor([81.64], device='cuda:0'), Acc 74.91390991210938, Best Acc 76.73898315429688. (lr 0.0069229202261942785, MMC 0.8151520490646362)
Epoch 61: TrainACC tensor([81.60], device='cuda:0'), Acc 76.54959106445312, Best Acc 76.73898315429688. (lr 0.0066260081767495396, MMC 0.8147872090339661)
Epoch 62: TrainACC tensor([81.84], device='cuda:0'), Acc 77.34159851074219, Best Acc 76.73898315429688. (lr 0.00633243571868007, MMC 0.8153533339500427)
Epoch 63: TrainACC tensor([81.85], device='cuda:0'), Acc 77.10055541992188, Best Acc 77.34159851074219. (lr 0.0060424925725585405, MMC 0.816024661064148)
Epoch 64: TrainACC tensor([82.16], device='cuda:0'), Acc 75.56818389892578, Best Acc 77.34159851074219. (lr 0.005756464877264925, MMC 0.8165187239646912)
Epoch 65: TrainACC tensor([82.20], device='cuda:0'), Acc 76.84228515625, Best Acc 77.34159851074219. (lr 0.005474634907601928, MMC 0.8170424699783325)
Epoch 66: TrainACC tensor([82.34], device='cuda:0'), Acc 77.37603759765625, Best Acc 77.34159851074219. (lr 0.005197280795723863, MMC 0.817593514919281)
Epoch 67: TrainACC tensor([82.57], device='cuda:0'), Acc 75.75757598876953, Best Acc 77.37603759765625. (lr 0.0049246762566537905, MMC 0.8181638121604919)
Epoch 68: TrainACC tensor([82.50], device='cuda:0'), Acc 76.68733215332031, Best Acc 77.37603759765625. (lr 0.004657090318159821, MMC 0.8187347650527954)
Epoch 69: TrainACC tensor([82.74], device='cuda:0'), Acc 77.58264923095703, Best Acc 77.37603759765625. (lr 0.004394787055257214, MMC 0.8190677165985107)
Epoch 70: TrainACC tensor([82.81], device='cuda:0'), Acc 77.23829650878906, Best Acc 77.58264923095703. (lr 0.004138025329598195, MMC 0.8193055391311646)
Epoch 71: TrainACC tensor([82.90], device='cuda:0'), Acc 78.09917449951172, Best Acc 77.58264923095703. (lr 0.0038870585340067642, MMC 0.8197123408317566)
Epoch 72: TrainACC tensor([82.90], device='cuda:0'), Acc 77.78926086425781, Best Acc 78.09917449951172. (lr 0.00364213434241059, MMC 0.8199592232704163)
Epoch 73: TrainACC tensor([83.39], device='cuda:0'), Acc 78.63291931152344, Best Acc 78.09917449951172. (lr 0.0034034944654167195, MMC 0.8202459216117859)
Epoch 74: TrainACC tensor([83.59], device='cuda:0'), Acc 78.3746566772461, Best Acc 78.63291931152344. (lr 0.0031713744117724, MMC 0.8208882212638855)
Epoch 75: TrainACC tensor([83.39], device='cuda:0'), Acc 78.40909576416016, Best Acc 78.63291931152344. (lr 0.0029460032559463912, MMC 0.8210296034812927)
Epoch 76: TrainACC tensor([83.87], device='cuda:0'), Acc 78.3746566772461, Best Acc 78.63291931152344. (lr 0.002727603412060101, MMC 0.8216763138771057)
Epoch 77: TrainACC tensor([83.65], device='cuda:0'), Acc 78.34022521972656, Best Acc 78.63291931152344. (lr 0.0025163904143917087, MMC 0.8218405246734619)
Epoch 78: TrainACC tensor([83.92], device='cuda:0'), Acc 78.58126831054688, Best Acc 78.63291931152344. (lr 0.0023125727046698664, MMC 0.822012186050415)
Epoch 79: TrainACC tensor([81.14], device='cuda:0'), Acc 76.80785369873047, Best Acc 78.63291931152344. (lr 0.002116351426366853, MMC 0.8218942880630493)
Epoch 80: TrainACC tensor([84.30], device='cuda:0'), Acc 78.82231140136719, Best Acc 78.63291931152344. (lr 0.0019279202261942763, MMC 0.8195404410362244)
Epoch 81: TrainACC tensor([84.42], device='cuda:0'), Acc 78.89118194580078, Best Acc 78.82231140136719. (lr 0.0017474650629971285, MMC 0.8175020217895508)
Epoch 82: TrainACC tensor([84.22], device='cuda:0'), Acc 78.49517822265625, Best Acc 78.89118194580078. (lr 0.0015751640242348717, MMC 0.8160063624382019)
Epoch 83: TrainACC tensor([84.39], device='cuda:0'), Acc 78.71900939941406, Best Acc 78.89118194580078. (lr 0.001411187150230602, MMC 0.8147382736206055)
Epoch 84: TrainACC tensor([84.47], device='cuda:0'), Acc 79.01171112060547, Best Acc 78.89118194580078. (lr 0.001255696266361803, MMC 0.8136337995529175)
Epoch 85: TrainACC tensor([84.71], device='cuda:0'), Acc 78.7362289428711, Best Acc 79.01171112060547. (lr 0.001108844823358206, MMC 0.8132038712501526)
Epoch 86: TrainACC tensor([84.65], device='cuda:0'), Acc 78.9772720336914, Best Acc 79.01171112060547. (lr 0.0009707777458644668, MMC 0.8129587173461914)
Epoch 87: TrainACC tensor([84.72], device='cuda:0'), Acc 79.45936584472656, Best Acc 79.01171112060547. (lr 0.0008416312894170307, MMC 0.8129374384880066)
Epoch 88: TrainACC tensor([84.80], device='cuda:0'), Acc 78.82231140136719, Best Acc 79.45936584472656. (lr 0.0007215329059763691, MMC 0.8129755258560181)
Epoch 89: TrainACC tensor([84.79], device='cuda:0'), Acc 79.25275421142578, Best Acc 79.45936584472656. (lr 0.0006106011181472877, MMC 0.812868058681488)
Epoch 90: TrainACC tensor([84.78], device='cuda:0'), Acc 78.89118194580078, Best Acc 79.45936584472656. (lr 0.0005089454022114163, MMC 0.8128895163536072)
Epoch 91: TrainACC tensor([84.98], device='cuda:0'), Acc 78.92562103271484, Best Acc 79.45936584472656. (lr 0.0004166660800873399, MMC 0.8128733038902283)
Epoch 92: TrainACC tensor([84.82], device='cuda:0'), Acc 78.7534408569336, Best Acc 79.45936584472656. (lr 0.00033385422032497665, MMC 0.8128215074539185)
Epoch 93: TrainACC tensor([84.83], device='cuda:0'), Acc 78.6673583984375, Best Acc 79.45936584472656. (lr 0.00026059154823191425, MMC 0.8126024007797241)
Epoch 94: TrainACC tensor([84.99], device='cuda:0'), Acc 79.51101684570312, Best Acc 79.45936584472656. (lr 0.00019695036522039968, MMC 0.8122926950454712)
Epoch 95: TrainACC tensor([85.02], device='cuda:0'), Acc 78.56404876708984, Best Acc 79.51101684570312. (lr 0.0001429934774545748, MMC 0.8119884133338928)
Epoch 96: TrainACC tensor([85.12], device='cuda:0'), Acc 78.87397003173828, Best Acc 79.51101684570312. (lr 9.877413386836714e-05, MMC 0.8116595149040222)
Epoch 97: TrainACC tensor([85.00], device='cuda:0'), Acc 79.09779357910156, Best Acc 79.51101684570312. (lr 6.433597361523084e-05, MMC 0.8114002346992493)
Epoch 98: TrainACC tensor([85.10], device='cuda:0'), Acc 78.58126831054688, Best Acc 79.51101684570312. (lr 3.971298300156713e-05, MMC 0.8109884858131409)
Epoch 99: TrainACC tensor([85.19], device='cuda:0'), Acc 78.94284057617188, Best Acc 79.51101684570312. (lr 2.4929461946341322e-05, MMC 0.8105961680412292)
